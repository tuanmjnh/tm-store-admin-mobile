import{d as U,k as $,G as F,r as b,g as f,w as u,$ as a,O as T,o as _,b as s,e,i as q,M as P,j as C}from"./index-CCiqnY4g.js";import{A as S}from"./index-C6BQ7keO.js";import{T as R,a as G}from"./index-Ct3VmShP.js";import{F as N}from"./index-df1euzin.js";import{_ as O}from"./index.vue_vue_type_style_index_0_lang-BXcNjKcJ.js";import{u as j}from"./roles-C1M3q8Vs.js";import{s as c,A as z,a as M}from"./function-call-DNrxL3W1.js";import{F as D}from"./index-BPe9Vb2s.js";import"./index-KPzygAO1.js";const ae=U({__name:"add",setup(E){const v=$(),m=j(),l=F(()=>m.item),p=b("basicInf"),g=b([]),i=b([]),x=async()=>{try{l.value.routes=i.value,l.value._id?(await m.update(l.value)).data&&c({type:"success",message:a("success.update")}):(await m.create(l.value)).data&&(c({type:"primary",message:a("success.create")}),m.setItem())}catch(o){o.data&&o.data.message?c({type:"danger",message:a(`error.${o.data.message}`)}):c({type:"danger",message:a(`http.${o.status}`)})}},w=o=>(l.value.routes&&l.value.routes.length&&l.value.routes.indexOf(o.name)>-1&&i.value.push(o.name),{id:o.name,name:a(`route.${o.meta.title}`,o.name),icon:o.meta.icon,disabled:!o.meta.requiresAuth}),y=o=>{const t=[];for(const n of o){if(!n.meta.requiresAuth)continue;const d=w(n);n.children&&n.children.length&&(d.children=y(n.children)),t.push(d)}return t};return(async()=>{v.params.id&&!l.value._id&&await m.getItem(v.params),g.value=y(T)})(),(o,t)=>{const n=N,d=C,V=R,I=G,h=S,k=z,A=M,B=D;return _(),f(B,{required:"auto",onSubmit:x},{default:u(()=>[s(I,{active:e(p),"onUpdate:active":t[6]||(t[6]=r=>q(p)?p.value=r:null)},{default:u(()=>[s(V,{title:e(a)("tabs.basicInf"),name:"basicInf"},{default:u(()=>[s(d,{inset:""},{default:u(()=>[s(n,{modelValue:e(l).key,"onUpdate:modelValue":t[0]||(t[0]=r=>e(l).key=r),name:"key",label:e(a)("global.key"),placeholder:e(a)("global.inputPlaceholder"),rules:[{required:!0,message:e(a)("error.required")}]},null,8,["modelValue","label","placeholder","rules"]),s(n,{modelValue:e(l).name,"onUpdate:modelValue":t[1]||(t[1]=r=>e(l).name=r),name:"name",label:e(a)("global.name"),placeholder:e(a)("global.inputPlaceholder"),rules:[{required:!0,message:e(a)("error.required")}]},null,8,["modelValue","label","placeholder","rules"]),s(n,{modelValue:e(l).color,"onUpdate:modelValue":t[2]||(t[2]=r=>e(l).color=r),name:"color",label:e(a)("global.color"),placeholder:e(a)("global.inputPlaceholder")},null,8,["modelValue","label","placeholder"]),s(n,{modelValue:e(l).level,"onUpdate:modelValue":t[3]||(t[3]=r=>e(l).level=r),name:"level",label:e(a)("global.level"),placeholder:e(a)("global.inputPlaceholder"),rules:[{required:!0,message:e(a)("error.required")}]},null,8,["modelValue","label","placeholder","rules"]),s(n,{modelValue:e(l).desc,"onUpdate:modelValue":t[4]||(t[4]=r=>e(l).desc=r),type:"textarea",rows:"1",autosize:"",name:"desc",label:e(a)("global.desc"),placeholder:e(a)("global.inputPlaceholder")},null,8,["modelValue","label","placeholder"])]),_:1})]),_:1},8,["title"]),s(V,{title:e(a)("tabs.routes"),name:"routes"},{default:u(()=>[s(O,{modelValue:e(i),"onUpdate:modelValue":t[5]||(t[5]=r=>q(i)?i.value=r:null),items:e(g),dense:"",selectable:"",color:"blue"},null,8,["modelValue","items"])]),_:1},8,["title"])]),_:1},8,["active"]),s(A,{placeholder:""},{default:u(()=>[s(h,{icon:"arrow-left",onClick:t[7]||(t[7]=r=>e(P)())}),s(h),e(l)._id?(_(),f(k,{key:0,type:"success","native-type":"submit",text:e(a)("global.update")},null,8,["text"])):(_(),f(k,{key:1,type:"primary","native-type":"submit",text:e(a)("global.add")},null,8,["text"]))]),_:1})]),_:1})}}});export{ae as default};
