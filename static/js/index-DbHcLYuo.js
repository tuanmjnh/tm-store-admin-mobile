const s=()=>{const t=new Error("Delay aborted");return t.name="AbortError",t},f=new WeakMap;function y({clearTimeout:t,setTimeout:m}={}){return(d,{value:i,signal:e}={})=>{if(e!=null&&e.aborted)return Promise.reject(s());let r,o,n;const c=t??clearTimeout,u=()=>{c(r),n(s())},l=()=>{e&&e.removeEventListener("abort",u)},a=new Promise((b,E)=>{o=()=>{l(),b(i)},n=E,r=(m??setTimeout)(o,d)});return e&&e.addEventListener("abort",u,{once:!0}),f.set(a,()=>{c(r),r=null,o()}),a}}const T=y();export{T as d};
