import{aq as wo,ar as ye,d as Ht,r as te,y as Le,z as Ar,A as bo,G as dt,o as Ve,c as qe,a as L,N as Co,aH as To,aI as _o,aL as $o,b as br,w as So,e as ae,E as Po,v as Eo,t as Do,F as Oo}from"./index-CdWp1Bke.js";const Cr={code:null,groups:[],title:null,desc:null,content:"",types:null,typeData:null,quantity:null,price:null,priceImport:null,priceExport:null,unit:null,brand:null,originName:null,originAddress:null,weight:null,date:null,pins:null,tags:null,attr:null,meta:null,images:null,attach:null,qrcode:null,barcode:null,order:1,flag:1,created:{at:null,by:null,ip:null}},me="products",ts=wo("productStore",{persist:!1,state:()=>({items:[],item:JSON.parse(JSON.stringify(Cr)),typeData:{price:0,priceImport:0,quantity:0},filter:{text:"",groups:[],flag:1,page:1,rowsPerPage:15}}),getters:{},actions:{async getAll(e){try{const a=await ye.axiosInstance.get(`/${me}/all`,{params:e});return this.all=a.data,a}catch(a){throw a}},async getItems(e){try{const a={...e};a.groups&&a.groups.length&&(a.groups=JSON.stringify(a.groups));const n=await ye.axiosInstance.get(`/${me}`,{params:a});return e.concat||(this.items=n.data),this.rowsNumber=n.rowsNumber,n}catch(a){throw a}},async getItem(e){try{const a=await ye.axiosInstance.get(`/${me}/${e.id}`,{params:e});return this.item=a.data,a}catch(a){throw a}},async find(e){try{const a=await ye.axiosInstance.get(`/${me}/find`,{params:e});return this.item=a.data,a}catch(a){throw a}},async create(e){try{const a=await ye.axiosInstance.post(`/${me}`,e);return a.status&&this.addItems(a.data),a}catch(a){throw a}},async duplicate(e){try{const a=await ye.axiosInstance.post(`/${me}/duplicate`,e);return a.status&&this.addItems(a.data),a}catch(a){throw a}},async update(e){try{const a=await ye.axiosInstance.put(`/${me}`,e);return a.status&&this.updateItems(a.data),a}catch(a){throw a}},async updateFlag(e){try{return await ye.axiosInstance.patch(`/${me}`,e)}catch(a){throw a}},async setItem(e){this.item=e?{...e}:JSON.parse(JSON.stringify(Cr))},async setItems(e){this.items=e||[]},async addItems(e,a){try{a?Array.isArray(e)?this.items.concat(e):this.items.push(e):Array.isArray(e)?this.items.concat(e):this.items.push(e)}catch(n){throw n}},async updateItems(e,a){try{if(Array.isArray(e))e.forEach(n=>{if(a){const s=a.findIndex(u=>u._id===n._id);s>-1&&a.splice(s,1,n)}else{const s=this.items.findIndex(u=>u._id===n._id);s>-1&&this.items.splice(s,1,n)}});else{const n=this.items.findIndex(s=>s._id===e._id);n>-1&&this.items.splice(n,1,e)}}catch(n){throw n}},async removeItems(e,a){try{if(Array.isArray(e))e.forEach(n=>{if(a){const s=a.findIndex(u=>u._id===n);s>-1&&a.splice(s,1)}else{const s=this.items.findIndex(u=>u._id===n);s>-1&&this.items.splice(s,1)}});else if(a){const n=a.findIndex(s=>s._id===e);n>-1&&a.splice(n,1)}else{const n=this.items.findIndex(s=>s._id===e);n>-1&&this.items.splice(n,1)}}catch(n){throw n}},generatorIdType(e){return e.map(n=>n.id).max()+1},addTypeGroup(e,a,n){e.types||(e.types=[]);const s={id:1,label:n};return e.types.push({label:a,options:[s]}),this.pushTypeDataOption(e,e.types.length-1,s),e},removeTypeGroup(e,a){return e.types.splice(a,1),e.types.length<1&&(e.types=null),this.removeTypeDataGroup(e),e.types},addTypeOption(e,a){const n={id:this.generatorIdType(e),label:a};return e.push(n),{options:e,option:n}},addTypeOptionItem(e,a,n){const s={id:this.generatorIdType(e.types[a].options),label:n};return e.types[a].options.push(s),this.pushTypeDataOption(e,a,s),{options:e.types[a].options,option:s}},removeTypeOption(e,a){const n=e.findIndex(s=>s.id===a);return n>-1&&e.splice(n,1),e},removeTypeOptionItem(e,a,n){const s=e.types[a].options.findIndex(u=>u.id===n);return s>-1&&e.types[a].options.splice(s,1),this.removeTypeDataOption(e,n),e.types[a].options},pushTypeData(e,a){if(e.typeData||(e.typeData={}),e.types.length==1)e.typeData[a.id]={...this.typeData};else{e.typeData[a.id]={};for(let n=0;n<e.types[1].options.length;n++)e.typeData[a.id][e.types[1].options[n].id]={...this.typeData}}},pushTypeDataOption(e,a,n){if(e.typeData||(e.typeData={}),a<1)if(e.types.length===1)e.typeData[n.id]={...this.typeData};else{e.typeData[n.id]={};for(let s=0;s<e.types[1].options.length;s++)e.typeData[n.id][e.types[1].options[s].id]={...this.typeData}}else if(e.types[1].options.length===1){const s={};for(const u in e.typeData)s[u]={},s[u][n.id]=Object.keys(e.typeData[u]).length?{...e.typeData[u]}:{...this.TypeData};e.typeData=s}else for(const s in e.typeData)e.typeData[s][n.id]={...this.typeData};return e.typeData},fixTypeData(e){if(!e.types||!e.types.length||!e.typeData)return!1;if(e.types.length==1){const a={};for(const n of e.types[0].options)a[n.id]=e.typeData[n.id];e.typeData=a}else if(e.types.length>1){const a={};for(const n of e.types[0].options){a[n.id]={};for(const s of e.types[1].options)a[n.id][s.id]=e.typeData[n.id][s.id]}e.typeData=a}return e.typeData},removeTypeDataGroup(e){if(!e.types||e.types.length<1)return null;if(e.types.length===1)e.typeData=Object.values(e.typeData)[0];else{const a={};for(const n in e.typeData)a[n]=Object.values(e.typeData[n][0]);e.typeData=a}},removeTypeDataOption(e,a){if(e.types.length===1)delete e.typeData[a];else for(const n in e.typeData)delete e.typeData[n][a];return e.typeData},async updateAllTypeData(e,a,n){if(e.length<2)for(const s in a)a[s].price=n.price?n.price:a[s].price,a[s].priceImport=n.priceImport?n.priceImport:a[s].priceImport,a[s].quantity=n.quantity?n.quantity:a[s].quantity;else for(const s in a)for(const u in a[s])a[s][u].price=n.price?n.price:a[s][u].price,a[s][u].priceImport=n.priceImport?n.priceImport:a[s][u].priceImport,a[s][u].quantity=n.quantity?n.quantity:a[s][u].quantity;return a},generateTypes(e){const a=[];return e.types&&e.types.length&&e.typeData?e.types.length===1?e.types[0].options.forEach(n=>{a.push({type1:e.types[0].label,label1:n.label,...e.typeData[n.id]})}):e.types.length===2&&e.types[0].options.forEach(n=>{e.types[1].options.forEach(s=>{a.push({type1:e.types[0].label,type2:e.types[1].label,label1:n.label,label2:s.label,...e.typeData[n.id][s.id]})})}):a.push({quantity:e.quantity,price:e.price,priceImport:e.priceImport}),a},getValueTypeData(e,a){const n=[];if(e.types.length==1)for(const s in e.typeData)n.push(e.typeData[s][a]);else if(e.types.length==2)for(const s in e.typeData)for(const u in e.typeData[s])n.push(e.typeData[s][u][a]);else n.push(e[a]);return n},getValueTypeDataMinMax(e,a,n,s){const u=this.getValueTypeData(e,a);return n?[s?u.min().format():u.min(),s?u.max().format():u.max()].join(n):[s?u.min().format():u.min(),s?u.max().format():u.max()]},getValueType(e,a,n,s){return e.types&&e.types.length?this.getValueTypeDataMinMax(e,a,n,s):e[a]?e[a].format():"0"},clear(){this.$reset()}}});var jr=(e,a,n)=>{if(!a.has(e))throw TypeError("Cannot "+n)},Tr=(e,a,n)=>(jr(e,a,"read from private field"),n?n.call(e):a.get(e)),xo=(e,a,n)=>{if(a.has(e))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(e):a.set(e,n)},Mo=(e,a,n,s)=>(jr(e,a,"write to private field"),a.set(e,n),n);const kr=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"]],Ao=[...kr,["unknown"]].map(e=>e[0]),ft=new Map(kr);function jo(e){for(const[a,n]of ft)if(e===n)return a;return"unknown"}function ko(e){if(Rr(e))return{width:e.naturalWidth,height:e.naturalHeight};if(Ir(e))return{width:e.width.baseVal.value,height:e.height.baseVal.value};if(Fr(e))return{width:e.videoWidth,height:e.videoHeight};if(Nr(e))return{width:e.width,height:e.height};if(Hr(e))return{width:e.displayWidth,height:e.displayHeight};if(Wr(e))return{width:e.width,height:e.height};if(Ur(e))return{width:e.width,height:e.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function Rr(e){try{return e instanceof HTMLImageElement}catch{return!1}}function Ir(e){try{return e instanceof SVGImageElement}catch{return!1}}function Fr(e){try{return e instanceof HTMLVideoElement}catch{return!1}}function Wr(e){try{return e instanceof HTMLCanvasElement}catch{return!1}}function Nr(e){try{return e instanceof ImageBitmap}catch{return!1}}function Ur(e){try{return e instanceof OffscreenCanvas}catch{return!1}}function Hr(e){try{return e instanceof VideoFrame}catch{return!1}}function Lr(e){try{return e instanceof Blob}catch{return!1}}function Ro(e){try{return e instanceof ImageData}catch{return!1}}function Io(e,a){try{const n=new OffscreenCanvas(e,a);if(n.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return n;throw void 0}catch{const s=document.createElement("canvas");return s.width=e,s.height=a,s}}async function Br(e){if(Rr(e)&&!await Uo(e))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(Ir(e)&&!await Ho(e))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(Hr(e)&&Lo(e))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(Fr(e)&&(e.readyState===0||e.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(Nr(e)&&Vo(e))throw new DOMException("The image source is detached.","InvalidStateError");const{width:a,height:n}=ko(e);if(a===0||n===0)return null;const s=Io(a,n).getContext("2d");s.drawImage(e,0,0);try{return s.getImageData(0,0,a,n)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function Fo(e){let a;try{if(globalThis.createImageBitmap)a=await createImageBitmap(e);else if(globalThis.Image){a=new Image;let n="";try{n=URL.createObjectURL(e),a.src=n,await a.decode()}finally{URL.revokeObjectURL(n)}}else return e}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}return await Br(a)}function Wo(e){const{width:a,height:n}=e;if(a===0||n===0)return null;const s=e.getContext("2d");try{return s.getImageData(0,0,a,n)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function No(e){if(Lr(e))return await Fo(e);if(Ro(e)){if(Bo(e))throw new DOMException("The image data has been detached.","InvalidStateError");return e}return Wr(e)||Ur(e)?Wo(e):await Br(e)}async function Uo(e){try{return await e.decode(),!0}catch{return!1}}async function Ho(e){var a;try{return await((a=e.decode)==null?void 0:a.call(e)),!0}catch{return!1}}function Lo(e){return e.format===null}function Bo(e){return e.data.buffer.byteLength===0}function Vo(e){return e.width===0&&e.height===0}function _r(e,a){return e instanceof DOMException?new DOMException(`${a}: ${e.message}`,e.name):e instanceof Error?new e.constructor(`${a}: ${e.message}`):new Error(`${a}: ${e}`)}const $r=["Aztec","Codabar","Code128","Code39","Code93","DataBar","DataBarExpanded","DataMatrix","DXFilmEdge","EAN-13","EAN-8","ITF","Linear-Codes","Matrix-Codes","MaxiCode","MicroQRCode","None","PDF417","QRCode","rMQRCode","UPC-A","UPC-E"];function qo(e){return e.join("|")}function zo(e){const a=Sr(e);let n=0,s=$r.length-1;for(;n<=s;){const u=Math.floor((n+s)/2),h=$r[u],y=Sr(h);if(y===a)return h;y<a?n=u+1:s=u-1}return"None"}function Sr(e){return e.toLowerCase().replace(/_-\[\]/g,"")}function Jo(e,a){return e.Binarizer[a]}function Go(e,a){return e.CharacterSet[a]}const Yo=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function Qo(e){return Yo[e.value]}function Xo(e,a){return e.EanAddOnSymbol[a]}function Ko(e,a){return e.TextMode[a]}const Me={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!1,validateCode39CheckSum:!1,validateITFCheckSum:!1,returnCodabarStartEnd:!1,returnErrors:!1,eanAddOnSymbol:"Read",textMode:"Plain",characterSet:"Unknown"};function Vr(e,a){return{...a,formats:qo(a.formats),binarizer:Jo(e,a.binarizer),eanAddOnSymbol:Xo(e,a.eanAddOnSymbol),textMode:Ko(e,a.textMode),characterSet:Go(e,a.characterSet)}}function qr(e){return{...e,format:zo(e.format),eccLevel:e.eccLevel,contentType:Qo(e.contentType)}}const Zo={locateFile:(e,a)=>{const n=e.match(/_(.+?)\.wasm$/);return n?`https://fastly.jsdelivr.net/npm/zxing-wasm@1.1.3/dist/${n[1]}/${e}`:a+e}};let Pr=new WeakMap;function Lt(e,a){var n;const s=Pr.get(e);if(s!=null&&s.modulePromise&&a===void 0)return s.modulePromise;const u=(n=s==null?void 0:s.moduleOverrides)!=null?n:Zo,h=e({...u});return Pr.set(e,{moduleOverrides:u,modulePromise:h}),h}async function ei(e,a,n=Me){const s={...Me,...n},u=await Lt(e),{size:h}=a,y=new Uint8Array(await a.arrayBuffer()),_=u._malloc(h);u.HEAPU8.set(y,_);const p=u.readBarcodesFromImage(_,h,Vr(u,s));u._free(_);const w=[];for(let C=0;C<p.size();++C)w.push(qr(p.get(C)));return w}async function ti(e,a,n=Me){const s={...Me,...n},u=await Lt(e),{data:h,width:y,height:_,data:{byteLength:p}}=a,w=u._malloc(p);u.HEAPU8.set(h,w);const C=u.readBarcodesFromPixmap(w,y,_,Vr(u,s));u._free(w);const b=[];for(let A=0;A<C.size();++A)b.push(qr(C.get(A)));return b}({...Me,formats:[...Me.formats]});var Bt=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(a={}){var n=a,s,u;n.ready=new Promise((t,r)=>{s=t,u=r});var h=Object.assign({},n),y="./this.program",_=typeof window=="object",p=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var w="";function C(t){return n.locateFile?n.locateFile(t,w):w+t}var b;(_||p)&&(p?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),e&&(w=e),w.indexOf("blob:")!==0?w=w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):w="",p&&(b=t=>{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)})),n.print||console.log.bind(console);var A=n.printErr||console.error.bind(console);Object.assign(n,h),h=null,n.arguments&&n.arguments,n.thisProgram&&(y=n.thisProgram),n.quit&&n.quit;var j;n.wasmBinary&&(j=n.wasmBinary),typeof WebAssembly!="object"&&Z("no native wasm support detected");var M,F=!1,N,E,k,I,D,O,oe,re;function $e(){var t=M.buffer;n.HEAP8=N=new Int8Array(t),n.HEAP16=k=new Int16Array(t),n.HEAPU8=E=new Uint8Array(t),n.HEAPU16=I=new Uint16Array(t),n.HEAP32=D=new Int32Array(t),n.HEAPU32=O=new Uint32Array(t),n.HEAPF32=oe=new Float32Array(t),n.HEAPF64=re=new Float64Array(t)}var Se=[],Ae=[],je=[];function ze(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)mt(n.preRun.shift());Ct(Se)}function vt(){Ct(Ae)}function yt(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)ke(n.postRun.shift());Ct(je)}function mt(t){Se.unshift(t)}function gt(t){Ae.unshift(t)}function ke(t){je.unshift(t)}var ie=0,Ce=null;function Je(t){var r;ie++,(r=n.monitorRunDependencies)===null||r===void 0||r.call(n,ie)}function he(t){var r;if(ie--,(r=n.monitorRunDependencies)===null||r===void 0||r.call(n,ie),ie==0&&Ce){var o=Ce;Ce=null,o()}}function Z(t){var r;(r=n.onAbort)===null||r===void 0||r.call(n,t),t="Aborted("+t+")",A(t),F=!0,t+=". Build with -sASSERTIONS for more info.";var o=new WebAssembly.RuntimeError(t);throw u(o),o}var wt="data:application/octet-stream;base64,",Ge=t=>t.startsWith(wt),ve;ve="zxing_reader.wasm",Ge(ve)||(ve=C(ve));function Ye(t){if(t==ve&&j)return new Uint8Array(j);if(b)return b(t);throw"both async and sync fetching of the wasm failed"}function bt(t){return!j&&(_||p)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw"failed to load wasm binary file at '"+t+"'";return r.arrayBuffer()}).catch(()=>Ye(t)):Promise.resolve().then(()=>Ye(t))}function Qe(t,r,o){return bt(t).then(i=>WebAssembly.instantiate(i,r)).then(i=>i).then(o,i=>{A(`failed to asynchronously prepare wasm: ${i}`),Z(i)})}function cn(t,r,o,i){return!t&&typeof WebAssembly.instantiateStreaming=="function"&&!Ge(r)&&typeof fetch=="function"?fetch(r,{credentials:"same-origin"}).then(c=>{var l=WebAssembly.instantiateStreaming(c,o);return l.then(i,function(d){return A(`wasm streaming compile failed: ${d}`),A("falling back to ArrayBuffer instantiation"),Qe(r,o,i)})}):Qe(r,o,i)}function un(){var t={a:Qa};function r(i,c){return G=i.exports,M=G.ia,$e(),Zt=G.ma,gt(G.ja),he(),G}Je();function o(i){r(i.instance)}if(n.instantiateWasm)try{return n.instantiateWasm(t,r)}catch(i){A(`Module.instantiateWasm callback failed with error: ${i}`),u(i)}return cn(j,ve,t,o).catch(u),{}}var Ct=t=>{for(;t.length>0;)t.shift()(n)};n.noExitRuntime;var Xe=[],Ke=0,ln=t=>{var r=new Tt(t);return r.get_caught()||(r.set_caught(!0),Ke--),r.set_rethrown(!1),Xe.push(r),pr(r.excPtr),r.get_exception_ptr()},de=0,dn=()=>{U(0,0);var t=Xe.pop();fr(t.excPtr),de=0};function Tt(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(r){O[this.ptr+4>>2]=r},this.get_type=function(){return O[this.ptr+4>>2]},this.set_destructor=function(r){O[this.ptr+8>>2]=r},this.get_destructor=function(){return O[this.ptr+8>>2]},this.set_caught=function(r){r=r?1:0,N[this.ptr+12>>0]=r},this.get_caught=function(){return N[this.ptr+12>>0]!=0},this.set_rethrown=function(r){r=r?1:0,N[this.ptr+13>>0]=r},this.get_rethrown=function(){return N[this.ptr+13>>0]!=0},this.init=function(r,o){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(o)},this.set_adjusted_ptr=function(r){O[this.ptr+16>>2]=r},this.get_adjusted_ptr=function(){return O[this.ptr+16>>2]},this.get_exception_ptr=function(){var r=vr(this.get_type());if(r)return O[this.excPtr>>2];var o=this.get_adjusted_ptr();return o!==0?o:this.excPtr}}var fn=t=>{throw de||(de=t),de},_t=t=>{var r=de;if(!r)return He(0),0;var o=new Tt(r);o.set_adjusted_ptr(r);var i=o.get_type();if(!i)return He(0),r;for(var c in t){var l=t[c];if(l===0||l===i)break;var d=o.ptr+16;if(hr(l,i,d))return He(l),r}return He(i),r},pn=()=>_t([]),hn=t=>_t([t]),vn=(t,r)=>_t([t,r]),yn=()=>{var t=Xe.pop();t||Z("no exception to throw");var r=t.excPtr;throw t.get_rethrown()||(Xe.push(t),t.set_rethrown(!0),t.set_caught(!1),Ke++),de=r,de},mn=(t,r,o)=>{var i=new Tt(t);throw i.init(r,o),de=t,Ke++,de},gn=()=>Ke,Ze={},$t=t=>{for(;t.length;){var r=t.pop(),o=t.pop();o(r)}};function St(t){return this.fromWireType(D[t>>2])}var Pe={},Te={},et={},Vt,tt=t=>{throw new Vt(t)},_e=(t,r,o)=>{t.forEach(function(f){et[f]=r});function i(f){var v=o(f);v.length!==t.length&&tt("Mismatched type converter count");for(var g=0;g<t.length;++g)se(t[g],v[g])}var c=new Array(r.length),l=[],d=0;r.forEach((f,v)=>{Te.hasOwnProperty(f)?c[v]=Te[f]:(l.push(f),Pe.hasOwnProperty(f)||(Pe[f]=[]),Pe[f].push(()=>{c[v]=Te[f],++d,d===l.length&&i(c)}))}),l.length===0&&i(c)},wn=t=>{var r=Ze[t];delete Ze[t];var o=r.rawConstructor,i=r.rawDestructor,c=r.fields,l=c.map(d=>d.getterReturnType).concat(c.map(d=>d.setterArgumentType));_e([t],l,d=>{var f={};return c.forEach((v,g)=>{var T=v.fieldName,S=d[g],P=v.getter,x=v.getterContext,H=d[g+c.length],z=v.setter,W=v.setterContext;f[T]={read:X=>S.fromWireType(P(x,X)),write:(X,m)=>{var $=[];z(W,X,H.toWireType($,m)),$t($)}}}),[{name:r.name,fromWireType:v=>{var g={};for(var T in f)g[T]=f[T].read(v);return i(v),g},toWireType:(v,g)=>{for(var T in f)if(!(T in g))throw new TypeError(`Missing field: "${T}"`);var S=o();for(T in f)f[T].write(S,g[T]);return v!==null&&v.push(i,S),S},argPackAdvance:ce,readValueFromPointer:St,destructorFunction:i}]})},bn=(t,r,o,i,c)=>{},Cn=()=>{for(var t=new Array(256),r=0;r<256;++r)t[r]=String.fromCharCode(r);qt=t},qt,Q=t=>{for(var r="",o=t;E[o];)r+=qt[E[o++]];return r},Ee,R=t=>{throw new Ee(t)};function Tn(t,r){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i=r.name;if(t||R(`type "${i}" must have a positive integer typeid pointer`),Te.hasOwnProperty(t)){if(o.ignoreDuplicateRegistrations)return;R(`Cannot register type '${i}' twice`)}if(Te[t]=r,delete et[t],Pe.hasOwnProperty(t)){var c=Pe[t];delete Pe[t],c.forEach(l=>l())}}function se(t,r){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Tn(t,r,o)}var ce=8,_n=(t,r,o,i)=>{r=Q(r),se(t,{name:r,fromWireType:function(c){return!!c},toWireType:function(c,l){return l?o:i},argPackAdvance:ce,readValueFromPointer:function(c){return this.fromWireType(E[c])},destructorFunction:null})},$n=t=>({count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType}),Pt=t=>{function r(o){return o.$$.ptrType.registeredClass.name}R(r(t)+" instance already deleted")},Et=!1,zt=t=>{},Sn=t=>{t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)},Jt=t=>{t.count.value-=1;var r=t.count.value===0;r&&Sn(t)},Gt=(t,r,o)=>{if(r===o)return t;if(o.baseClass===void 0)return null;var i=Gt(t,r,o.baseClass);return i===null?null:o.downcast(i)},Yt={},Pn=()=>Object.keys(Fe).length,En=()=>{var t=[];for(var r in Fe)Fe.hasOwnProperty(r)&&t.push(Fe[r]);return t},Re=[],Dt=()=>{for(;Re.length;){var t=Re.pop();t.$$.deleteScheduled=!1,t.delete()}},Ie,Dn=t=>{Ie=t,Re.length&&Ie&&Ie(Dt)},On=()=>{n.getInheritedInstanceCount=Pn,n.getLiveInheritedInstances=En,n.flushPendingDeletes=Dt,n.setDelayFunction=Dn},Fe={},xn=(t,r)=>{for(r===void 0&&R("ptr should not be undefined");t.baseClass;)r=t.upcast(r),t=t.baseClass;return r},Mn=(t,r)=>(r=xn(t,r),Fe[r]),rt=(t,r)=>{(!r.ptrType||!r.ptr)&&tt("makeClassHandle requires ptr and ptrType");var o=!!r.smartPtrType,i=!!r.smartPtr;return o!==i&&tt("Both smartPtrType and smartPtr must be specified"),r.count={value:1},We(Object.create(t,{$$:{value:r,writable:!0}}))};function An(t){var r=this.getPointee(t);if(!r)return this.destructor(t),null;var o=Mn(this.registeredClass,r);if(o!==void 0){if(o.$$.count.value===0)return o.$$.ptr=r,o.$$.smartPtr=t,o.clone();var i=o.clone();return this.destructor(t),i}function c(){return this.isSmartPointer?rt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:r,smartPtrType:this,smartPtr:t}):rt(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var l=this.registeredClass.getActualType(r),d=Yt[l];if(!d)return c.call(this);var f;this.isConst?f=d.constPointerType:f=d.pointerType;var v=Gt(r,this.registeredClass,f.registeredClass);return v===null?c.call(this):this.isSmartPointer?rt(f.registeredClass.instancePrototype,{ptrType:f,ptr:v,smartPtrType:this,smartPtr:t}):rt(f.registeredClass.instancePrototype,{ptrType:f,ptr:v})}var We=t=>typeof FinalizationRegistry>"u"?(We=r=>r,t):(Et=new FinalizationRegistry(r=>{Jt(r.$$)}),We=r=>{var o=r.$$,i=!!o.smartPtr;if(i){var c={$$:o};Et.register(r,c,r)}return r},zt=r=>Et.unregister(r),We(t)),jn=()=>{Object.assign(nt.prototype,{isAliasOf(t){if(!(this instanceof nt)||!(t instanceof nt))return!1;var r=this.$$.ptrType.registeredClass,o=this.$$.ptr;t.$$=t.$$;for(var i=t.$$.ptrType.registeredClass,c=t.$$.ptr;r.baseClass;)o=r.upcast(o),r=r.baseClass;for(;i.baseClass;)c=i.upcast(c),i=i.baseClass;return r===i&&o===c},clone(){if(this.$$.ptr||Pt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var t=We(Object.create(Object.getPrototypeOf(this),{$$:{value:$n(this.$$)}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t},delete(){this.$$.ptr||Pt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&R("Object already scheduled for deletion"),zt(this),Jt(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||Pt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&R("Object already scheduled for deletion"),Re.push(this),Re.length===1&&Ie&&Ie(Dt),this.$$.deleteScheduled=!0,this}})};function nt(){}var Ne=(t,r)=>Object.defineProperty(r,"name",{value:t}),Qt=(t,r,o)=>{if(t[r].overloadTable===void 0){var i=t[r];t[r]=function(){return t[r].overloadTable.hasOwnProperty(arguments.length)||R(`Function '${o}' called with an invalid number of arguments (${arguments.length}) - expects one of (${t[r].overloadTable})!`),t[r].overloadTable[arguments.length].apply(this,arguments)},t[r].overloadTable=[],t[r].overloadTable[i.argCount]=i}},Ot=(t,r,o)=>{n.hasOwnProperty(t)?((o===void 0||n[t].overloadTable!==void 0&&n[t].overloadTable[o]!==void 0)&&R(`Cannot register public name '${t}' twice`),Qt(n,t,t),n.hasOwnProperty(o)&&R(`Cannot register multiple overloads of a function with the same number of arguments (${o})!`),n[t].overloadTable[o]=r):(n[t]=r,o!==void 0&&(n[t].numArguments=o))},kn=48,Rn=57,In=t=>{if(t===void 0)return"_unknown";t=t.replace(/[^a-zA-Z0-9_]/g,"$");var r=t.charCodeAt(0);return r>=kn&&r<=Rn?`_${t}`:t};function Fn(t,r,o,i,c,l,d,f){this.name=t,this.constructor=r,this.instancePrototype=o,this.rawDestructor=i,this.baseClass=c,this.getActualType=l,this.upcast=d,this.downcast=f,this.pureVirtualFunctions=[]}var xt=(t,r,o)=>{for(;r!==o;)r.upcast||R(`Expected null or instance of ${o.name}, got an instance of ${r.name}`),t=r.upcast(t),r=r.baseClass;return t};function Wn(t,r){if(r===null)return this.isReference&&R(`null is not a valid ${this.name}`),0;r.$$||R(`Cannot pass "${Rt(r)}" as a ${this.name}`),r.$$.ptr||R(`Cannot pass deleted object as a pointer of type ${this.name}`);var o=r.$$.ptrType.registeredClass,i=xt(r.$$.ptr,o,this.registeredClass);return i}function Nn(t,r){var o;if(r===null)return this.isReference&&R(`null is not a valid ${this.name}`),this.isSmartPointer?(o=this.rawConstructor(),t!==null&&t.push(this.rawDestructor,o),o):0;(!r||!r.$$)&&R(`Cannot pass "${Rt(r)}" as a ${this.name}`),r.$$.ptr||R(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&r.$$.ptrType.isConst&&R(`Cannot convert argument of type ${r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name} to parameter type ${this.name}`);var i=r.$$.ptrType.registeredClass;if(o=xt(r.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(r.$$.smartPtr===void 0&&R("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:r.$$.smartPtrType===this?o=r.$$.smartPtr:R(`Cannot convert argument of type ${r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:o=r.$$.smartPtr;break;case 2:if(r.$$.smartPtrType===this)o=r.$$.smartPtr;else{var c=r.clone();o=this.rawShare(o,fe.toHandle(()=>c.delete())),t!==null&&t.push(this.rawDestructor,o)}break;default:R("Unsupporting sharing policy")}return o}function Un(t,r){if(r===null)return this.isReference&&R(`null is not a valid ${this.name}`),0;r.$$||R(`Cannot pass "${Rt(r)}" as a ${this.name}`),r.$$.ptr||R(`Cannot pass deleted object as a pointer of type ${this.name}`),r.$$.ptrType.isConst&&R(`Cannot convert argument of type ${r.$$.ptrType.name} to parameter type ${this.name}`);var o=r.$$.ptrType.registeredClass,i=xt(r.$$.ptr,o,this.registeredClass);return i}function Xt(t){return this.fromWireType(O[t>>2])}var Hn=()=>{Object.assign(at.prototype,{getPointee(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t},destructor(t){var r;(r=this.rawDestructor)===null||r===void 0||r.call(this,t)},argPackAdvance:ce,readValueFromPointer:Xt,deleteObject(t){t!==null&&t.delete()},fromWireType:An})};function at(t,r,o,i,c,l,d,f,v,g,T){this.name=t,this.registeredClass=r,this.isReference=o,this.isConst=i,this.isSmartPointer=c,this.pointeeType=l,this.sharingPolicy=d,this.rawGetPointee=f,this.rawConstructor=v,this.rawShare=g,this.rawDestructor=T,!c&&r.baseClass===void 0?i?(this.toWireType=Wn,this.destructorFunction=null):(this.toWireType=Un,this.destructorFunction=null):this.toWireType=Nn}var Kt=(t,r,o)=>{n.hasOwnProperty(t)||tt("Replacing nonexistant public symbol"),n[t].overloadTable!==void 0&&o!==void 0?n[t].overloadTable[o]=r:(n[t]=r,n[t].argCount=o)},Ln=(t,r,o)=>{var i=n["dynCall_"+t];return o&&o.length?i.apply(null,[r].concat(o)):i.call(null,r)},ot=[],Zt,B=t=>{var r=ot[t];return r||(t>=ot.length&&(ot.length=t+1),ot[t]=r=Zt.get(t)),r},Bn=(t,r,o)=>{if(t.includes("j"))return Ln(t,r,o);var i=B(r).apply(null,o);return i},Vn=(t,r)=>{var o=[];return function(){return o.length=0,Object.assign(o,arguments),Bn(t,r,o)}},ne=(t,r)=>{t=Q(t);function o(){return t.includes("j")?Vn(t,r):B(r)}var i=o();return typeof i!="function"&&R(`unknown function pointer with signature ${t}: ${r}`),i},qn=(t,r)=>{var o=Ne(r,function(i){this.name=r,this.message=i;var c=new Error(i).stack;c!==void 0&&(this.stack=this.toString()+`
`+c.replace(/^Error(:[^\n]*)?\n/,""))});return o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},o},er,tr=t=>{var r=dr(t),o=Q(r);return pe(r),o},it=(t,r)=>{var o=[],i={};function c(l){if(!i[l]&&!Te[l]){if(et[l]){et[l].forEach(c);return}o.push(l),i[l]=!0}}throw r.forEach(c),new er(`${t}: `+o.map(tr).join([", "]))},zn=(t,r,o,i,c,l,d,f,v,g,T,S,P)=>{T=Q(T),l=ne(c,l),f&&(f=ne(d,f)),g&&(g=ne(v,g)),P=ne(S,P);var x=In(T);Ot(x,function(){it(`Cannot construct ${T} due to unbound types`,[i])}),_e([t,r,o],i?[i]:[],function(H){H=H[0];var z,W;i?(z=H.registeredClass,W=z.instancePrototype):W=nt.prototype;var X=Ne(T,function(){if(Object.getPrototypeOf(this)!==m)throw new Ee("Use 'new' to construct "+T);if($.constructor_body===void 0)throw new Ee(T+" has no accessible constructor");var wr=$.constructor_body[arguments.length];if(wr===void 0)throw new Ee(`Tried to invoke ctor of ${T} with invalid number of parameters (${arguments.length}) - expected (${Object.keys($.constructor_body).toString()}) parameters instead!`);return wr.apply(this,arguments)}),m=Object.create(W,{constructor:{value:X}});X.prototype=m;var $=new Fn(T,X,m,P,z,l,f,g);if($.baseClass){var J,Y;(Y=(J=$.baseClass).__derivedClasses)!==null&&Y!==void 0||(J.__derivedClasses=[]),$.baseClass.__derivedClasses.push($)}var De=new at(T,$,!0,!1,!1),ut=new at(T+"*",$,!1,!1,!1),gr=new at(T+" const*",$,!1,!0,!1);return Yt[t]={pointerType:ut,constPointerType:gr},Kt(x,X),[De,ut,gr]})},Mt=(t,r)=>{for(var o=[],i=0;i<t;i++)o.push(O[r+i*4>>2]);return o};function Jn(t){for(var r=1;r<t.length;++r)if(t[r]!==null&&t[r].destructorFunction===void 0)return!0;return!1}function At(t,r,o,i,c,l){var d=r.length;d<2&&R("argTypes array size mismatch! Must at least get return value and 'this' types!");var f=r[1]!==null&&o!==null,v=Jn(r),g=r[0].name!=="void",T=d-2,S=new Array(T),P=[],x=[],H=function(){arguments.length!==T&&R(`function ${t} called with ${arguments.length} arguments, expected ${T}`),x.length=0;var z;P.length=f?2:1,P[0]=c,f&&(z=r[1].toWireType(x,this),P[1]=z);for(var W=0;W<T;++W)S[W]=r[W+2].toWireType(x,arguments[W]),P.push(S[W]);var X=i.apply(null,P);function m($){if(v)$t(x);else for(var J=f?1:2;J<r.length;J++){var Y=J===1?z:S[J-2];r[J].destructorFunction!==null&&r[J].destructorFunction(Y)}if(g)return r[0].fromWireType($)}return m(X)};return Ne(t,H)}var Gn=(t,r,o,i,c,l)=>{var d=Mt(r,o);c=ne(i,c),_e([],[t],function(f){f=f[0];var v=`constructor ${f.name}`;if(f.registeredClass.constructor_body===void 0&&(f.registeredClass.constructor_body=[]),f.registeredClass.constructor_body[r-1]!==void 0)throw new Ee(`Cannot register multiple constructors with identical number of parameters (${r-1}) for class '${f.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return f.registeredClass.constructor_body[r-1]=()=>{it(`Cannot construct ${f.name} due to unbound types`,d)},_e([],d,g=>(g.splice(1,0,null),f.registeredClass.constructor_body[r-1]=At(v,g,null,c,l),[])),[]})},rr=t=>{t=t.trim();const r=t.indexOf("(");return r!==-1?t.substr(0,r):t},Yn=(t,r,o,i,c,l,d,f,v)=>{var g=Mt(o,i);r=Q(r),r=rr(r),l=ne(c,l),_e([],[t],function(T){T=T[0];var S=`${T.name}.${r}`;r.startsWith("@@")&&(r=Symbol[r.substring(2)]),f&&T.registeredClass.pureVirtualFunctions.push(r);function P(){it(`Cannot call ${S} due to unbound types`,g)}var x=T.registeredClass.instancePrototype,H=x[r];return H===void 0||H.overloadTable===void 0&&H.className!==T.name&&H.argCount===o-2?(P.argCount=o-2,P.className=T.name,x[r]=P):(Qt(x,r,S),x[r].overloadTable[o-2]=P),_e([],g,function(z){var W=At(S,z,T,l,d);return x[r].overloadTable===void 0?(W.argCount=o-2,x[r]=W):x[r].overloadTable[o-2]=W,[]}),[]})};function Qn(){Object.assign(nr.prototype,{get(t){return this.allocated[t]},has(t){return this.allocated[t]!==void 0},allocate(t){var r=this.freelist.pop()||this.allocated.length;return this.allocated[r]=t,r},free(t){this.allocated[t]=void 0,this.freelist.push(t)}})}function nr(){this.allocated=[void 0],this.freelist=[]}var ee=new nr,jt=t=>{t>=ee.reserved&&--ee.get(t).refcount===0&&ee.free(t)},Xn=()=>{for(var t=0,r=ee.reserved;r<ee.allocated.length;++r)ee.allocated[r]!==void 0&&++t;return t},Kn=()=>{ee.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),ee.reserved=ee.allocated.length,n.count_emval_handles=Xn},fe={toValue:t=>(t||R("Cannot use deleted val. handle = "+t),ee.get(t).value),toHandle:t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return ee.allocate({refcount:1,value:t})}}},Zn=(t,r)=>{r=Q(r),se(t,{name:r,fromWireType:o=>{var i=fe.toValue(o);return jt(o),i},toWireType:(o,i)=>fe.toHandle(i),argPackAdvance:ce,readValueFromPointer:St,destructorFunction:null})},ea=(t,r,o)=>{switch(r){case 1:return o?function(i){return this.fromWireType(N[i>>0])}:function(i){return this.fromWireType(E[i>>0])};case 2:return o?function(i){return this.fromWireType(k[i>>1])}:function(i){return this.fromWireType(I[i>>1])};case 4:return o?function(i){return this.fromWireType(D[i>>2])}:function(i){return this.fromWireType(O[i>>2])};default:throw new TypeError(`invalid integer width (${r}): ${t}`)}},ta=(t,r,o,i)=>{r=Q(r);function c(){}c.values={},se(t,{name:r,constructor:c,fromWireType:function(l){return this.constructor.values[l]},toWireType:(l,d)=>d.value,argPackAdvance:ce,readValueFromPointer:ea(r,o,i),destructorFunction:null}),Ot(r,c)},kt=(t,r)=>{var o=Te[t];return o===void 0&&R(r+" has unknown type "+tr(t)),o},ra=(t,r,o)=>{var i=kt(t,"enum");r=Q(r);var c=i.constructor,l=Object.create(i.constructor.prototype,{value:{value:o},constructor:{value:Ne(`${i.name}_${r}`,function(){})}});c.values[o]=l,c[r]=l},Rt=t=>{if(t===null)return"null";var r=typeof t;return r==="object"||r==="array"||r==="function"?t.toString():""+t},na=(t,r)=>{switch(r){case 4:return function(o){return this.fromWireType(oe[o>>2])};case 8:return function(o){return this.fromWireType(re[o>>3])};default:throw new TypeError(`invalid float width (${r}): ${t}`)}},aa=(t,r,o)=>{r=Q(r),se(t,{name:r,fromWireType:i=>i,toWireType:(i,c)=>c,argPackAdvance:ce,readValueFromPointer:na(r,o),destructorFunction:null})},oa=(t,r,o,i,c,l,d)=>{var f=Mt(r,o);t=Q(t),t=rr(t),c=ne(i,c),Ot(t,function(){it(`Cannot call ${t} due to unbound types`,f)},r-1),_e([],f,function(v){var g=[v[0],null].concat(v.slice(1));return Kt(t,At(t,g,null,c,l),r-1),[]})},ia=(t,r,o)=>{switch(r){case 1:return o?i=>N[i>>0]:i=>E[i>>0];case 2:return o?i=>k[i>>1]:i=>I[i>>1];case 4:return o?i=>D[i>>2]:i=>O[i>>2];default:throw new TypeError(`invalid integer width (${r}): ${t}`)}},sa=(t,r,o,i,c)=>{r=Q(r);var l=T=>T;if(i===0){var d=32-8*o;l=T=>T<<d>>>d}var f=r.includes("unsigned"),v=(T,S)=>{},g;f?g=function(T,S){return v(S,this.name),S>>>0}:g=function(T,S){return v(S,this.name),S},se(t,{name:r,fromWireType:l,toWireType:g,argPackAdvance:ce,readValueFromPointer:ia(r,o,i!==0),destructorFunction:null})},ca=(t,r,o)=>{var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],c=i[r];function l(d){var f=O[d>>2],v=O[d+4>>2];return new c(N.buffer,v,f)}o=Q(o),se(t,{name:o,fromWireType:l,argPackAdvance:ce,readValueFromPointer:l},{ignoreDuplicateRegistrations:!0})},ar=(t,r,o,i)=>{if(!(i>0))return 0;for(var c=o,l=o+i-1,d=0;d<t.length;++d){var f=t.charCodeAt(d);if(f>=55296&&f<=57343){var v=t.charCodeAt(++d);f=65536+((f&1023)<<10)|v&1023}if(f<=127){if(o>=l)break;r[o++]=f}else if(f<=2047){if(o+1>=l)break;r[o++]=192|f>>6,r[o++]=128|f&63}else if(f<=65535){if(o+2>=l)break;r[o++]=224|f>>12,r[o++]=128|f>>6&63,r[o++]=128|f&63}else{if(o+3>=l)break;r[o++]=240|f>>18,r[o++]=128|f>>12&63,r[o++]=128|f>>6&63,r[o++]=128|f&63}}return r[o]=0,o-c},ua=(t,r,o)=>ar(t,E,r,o),or=t=>{for(var r=0,o=0;o<t.length;++o){var i=t.charCodeAt(o);i<=127?r++:i<=2047?r+=2:i>=55296&&i<=57343?(r+=4,++o):r+=3}return r},ir=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,la=(t,r,o)=>{for(var i=r+o,c=r;t[c]&&!(c>=i);)++c;if(c-r>16&&t.buffer&&ir)return ir.decode(t.subarray(r,c));for(var l="";r<c;){var d=t[r++];if(!(d&128)){l+=String.fromCharCode(d);continue}var f=t[r++]&63;if((d&224)==192){l+=String.fromCharCode((d&31)<<6|f);continue}var v=t[r++]&63;if((d&240)==224?d=(d&15)<<12|f<<6|v:d=(d&7)<<18|f<<12|v<<6|t[r++]&63,d<65536)l+=String.fromCharCode(d);else{var g=d-65536;l+=String.fromCharCode(55296|g>>10,56320|g&1023)}}return l},It=(t,r)=>t?la(E,t,r):"",da=(t,r)=>{r=Q(r);var o=r==="std::string";se(t,{name:r,fromWireType(i){var c=O[i>>2],l=i+4,d;if(o)for(var f=l,v=0;v<=c;++v){var g=l+v;if(v==c||E[g]==0){var T=g-f,S=It(f,T);d===void 0?d=S:(d+="\0",d+=S),f=g+1}}else{for(var P=new Array(c),v=0;v<c;++v)P[v]=String.fromCharCode(E[l+v]);d=P.join("")}return pe(i),d},toWireType(i,c){c instanceof ArrayBuffer&&(c=new Uint8Array(c));var l,d=typeof c=="string";d||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int8Array||R("Cannot pass non-string to std::string"),o&&d?l=or(c):l=c.length;var f=Nt(4+l+1),v=f+4;if(O[f>>2]=l,o&&d)ua(c,v,l+1);else if(d)for(var g=0;g<l;++g){var T=c.charCodeAt(g);T>255&&(pe(v),R("String has UTF-16 code units that do not fit in 8 bits")),E[v+g]=T}else for(var g=0;g<l;++g)E[v+g]=c[g];return i!==null&&i.push(pe,f),f},argPackAdvance:ce,readValueFromPointer:Xt,destructorFunction(i){pe(i)}})},sr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,fa=(t,r)=>{for(var o=t,i=o>>1,c=i+r/2;!(i>=c)&&I[i];)++i;if(o=i<<1,o-t>32&&sr)return sr.decode(E.subarray(t,o));for(var l="",d=0;!(d>=r/2);++d){var f=k[t+d*2>>1];if(f==0)break;l+=String.fromCharCode(f)}return l},pa=(t,r,o)=>{var i;if((i=o)!==null&&i!==void 0||(o=2147483647),o<2)return 0;o-=2;for(var c=r,l=o<t.length*2?o/2:t.length,d=0;d<l;++d){var f=t.charCodeAt(d);k[r>>1]=f,r+=2}return k[r>>1]=0,r-c},ha=t=>t.length*2,va=(t,r)=>{for(var o=0,i="";!(o>=r/4);){var c=D[t+o*4>>2];if(c==0)break;if(++o,c>=65536){var l=c-65536;i+=String.fromCharCode(55296|l>>10,56320|l&1023)}else i+=String.fromCharCode(c)}return i},ya=(t,r,o)=>{var i;if((i=o)!==null&&i!==void 0||(o=2147483647),o<4)return 0;for(var c=r,l=c+o-4,d=0;d<t.length;++d){var f=t.charCodeAt(d);if(f>=55296&&f<=57343){var v=t.charCodeAt(++d);f=65536+((f&1023)<<10)|v&1023}if(D[r>>2]=f,r+=4,r+4>l)break}return D[r>>2]=0,r-c},ma=t=>{for(var r=0,o=0;o<t.length;++o){var i=t.charCodeAt(o);i>=55296&&i<=57343&&++o,r+=4}return r},ga=(t,r,o)=>{o=Q(o);var i,c,l,d,f;r===2?(i=fa,c=pa,d=ha,l=()=>I,f=1):r===4&&(i=va,c=ya,d=ma,l=()=>O,f=2),se(t,{name:o,fromWireType:v=>{for(var g=O[v>>2],T=l(),S,P=v+4,x=0;x<=g;++x){var H=v+4+x*r;if(x==g||T[H>>f]==0){var z=H-P,W=i(P,z);S===void 0?S=W:(S+="\0",S+=W),P=H+r}}return pe(v),S},toWireType:(v,g)=>{typeof g!="string"&&R(`Cannot pass non-string to C++ string type ${o}`);var T=d(g),S=Nt(4+T+r);return O[S>>2]=T>>f,c(g,S+4,T+r),v!==null&&v.push(pe,S),S},argPackAdvance:ce,readValueFromPointer:St,destructorFunction(v){pe(v)}})},wa=(t,r,o,i,c,l)=>{Ze[t]={name:Q(r),rawConstructor:ne(o,i),rawDestructor:ne(c,l),fields:[]}},ba=(t,r,o,i,c,l,d,f,v,g)=>{Ze[t].fields.push({fieldName:Q(r),getterReturnType:o,getter:ne(i,c),getterContext:l,setterArgumentType:d,setter:ne(f,v),setterContext:g})},Ca=(t,r)=>{r=Q(r),se(t,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:()=>{},toWireType:(o,i)=>{}})},Ft=[],Ta=(t,r,o,i)=>(t=Ft[t],r=fe.toValue(r),t(null,r,o,i)),_a={},$a=t=>{var r=_a[t];return r===void 0?Q(t):r},cr=()=>{if(typeof globalThis=="object")return globalThis;function t(r){r.$$$embind_global$$$=r;var o=typeof $$$embind_global$$$=="object"&&r.$$$embind_global$$$==r;return o||delete r.$$$embind_global$$$,o}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&t(global)?$$$embind_global$$$=global:typeof self=="object"&&t(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Sa=t=>t===0?fe.toHandle(cr()):(t=$a(t),fe.toHandle(cr()[t])),Pa=t=>{var r=Ft.length;return Ft.push(t),r},Ea=(t,r)=>{for(var o=new Array(t),i=0;i<t;++i)o[i]=kt(O[r+i*4>>2],"parameter "+i);return o},Da=Reflect.construct,Oa=(t,r,o)=>{var i=[],c=t.toWireType(i,o);return i.length&&(O[r>>2]=fe.toHandle(i)),c},xa=(t,r,o)=>{var i=Ea(t,r),c=i.shift();t--;var l=new Array(t),d=(v,g,T,S)=>{for(var P=0,x=0;x<t;++x)l[x]=i[x].readValueFromPointer(S+P),P+=i[x].argPackAdvance;for(var H=o===1?Da(g,l):g.apply(v,l),x=0;x<t;++x){var z,W;(z=(W=i[x]).deleteObject)===null||z===void 0||z.call(W,l[x])}return Oa(c,T,H)},f=`methodCaller<(${i.map(v=>v.name).join(", ")}) => ${c.name}>`;return Pa(Ne(f,d))},Ma=t=>{t>4&&(ee.get(t).refcount+=1)},Aa=t=>{var r=fe.toValue(t);$t(r),jt(t)},ja=(t,r)=>{t=kt(t,"_emval_take_value");var o=t.readValueFromPointer(r);return fe.toHandle(o)},ka=()=>{Z("")},Ra=(t,r,o)=>E.copyWithin(t,r,r+o),Ia=()=>2147483648,Fa=t=>{var r=M.buffer,o=(t-r.byteLength+65535)/65536;try{return M.grow(o),$e(),1}catch{}},Wa=t=>{var r=E.length;t>>>=0;var o=Ia();if(t>o)return!1;for(var i=(v,g)=>v+(g-v%g)%g,c=1;c<=4;c*=2){var l=r*(1+.2/c);l=Math.min(l,t+100663296);var d=Math.min(o,i(Math.max(t,l),65536)),f=Fa(d);if(f)return!0}return!1},Wt={},Na=()=>y||"./this.program",Ue=()=>{if(!Ue.strings){var t=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:Na()};for(var o in Wt)Wt[o]===void 0?delete r[o]:r[o]=Wt[o];var i=[];for(var o in r)i.push(`${o}=${r[o]}`);Ue.strings=i}return Ue.strings},Ua=(t,r)=>{for(var o=0;o<t.length;++o)N[r++>>0]=t.charCodeAt(o);N[r>>0]=0},Ha=(t,r)=>{var o=0;return Ue().forEach((i,c)=>{var l=r+o;O[t+c*4>>2]=l,Ua(i,l),o+=i.length+1}),0},La=(t,r)=>{var o=Ue();O[t>>2]=o.length;var i=0;return o.forEach(c=>i+=c.length+1),O[r>>2]=i,0},Ba=t=>t,st=t=>t%4===0&&(t%100!==0||t%400===0),Va=(t,r)=>{for(var o=0,i=0;i<=r;o+=t[i++]);return o},ur=[31,29,31,30,31,30,31,31,30,31,30,31],lr=[31,28,31,30,31,30,31,31,30,31,30,31],qa=(t,r)=>{for(var o=new Date(t.getTime());r>0;){var i=st(o.getFullYear()),c=o.getMonth(),l=(i?ur:lr)[c];if(r>l-o.getDate())r-=l-o.getDate()+1,o.setDate(1),c<11?o.setMonth(c+1):(o.setMonth(0),o.setFullYear(o.getFullYear()+1));else return o.setDate(o.getDate()+r),o}return o};function za(t,r,o){var i=or(t)+1,c=new Array(i);return ar(t,c,0,c.length),c}var Ja=(t,r)=>{N.set(t,r)},Ga=(t,r,o,i)=>{var c=O[i+40>>2],l={tm_sec:D[i>>2],tm_min:D[i+4>>2],tm_hour:D[i+8>>2],tm_mday:D[i+12>>2],tm_mon:D[i+16>>2],tm_year:D[i+20>>2],tm_wday:D[i+24>>2],tm_yday:D[i+28>>2],tm_isdst:D[i+32>>2],tm_gmtoff:D[i+36>>2],tm_zone:c?It(c):""},d=It(o),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var v in f)d=d.replace(new RegExp(v,"g"),f[v]);var g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T=["January","February","March","April","May","June","July","August","September","October","November","December"];function S(m,$,J){for(var Y=typeof m=="number"?m.toString():m||"";Y.length<$;)Y=J[0]+Y;return Y}function P(m,$){return S(m,$,"0")}function x(m,$){function J(De){return De<0?-1:De>0?1:0}var Y;return(Y=J(m.getFullYear()-$.getFullYear()))===0&&(Y=J(m.getMonth()-$.getMonth()))===0&&(Y=J(m.getDate()-$.getDate())),Y}function H(m){switch(m.getDay()){case 0:return new Date(m.getFullYear()-1,11,29);case 1:return m;case 2:return new Date(m.getFullYear(),0,3);case 3:return new Date(m.getFullYear(),0,2);case 4:return new Date(m.getFullYear(),0,1);case 5:return new Date(m.getFullYear()-1,11,31);case 6:return new Date(m.getFullYear()-1,11,30)}}function z(m){var $=qa(new Date(m.tm_year+1900,0,1),m.tm_yday),J=new Date($.getFullYear(),0,4),Y=new Date($.getFullYear()+1,0,4),De=H(J),ut=H(Y);return x(De,$)<=0?x(ut,$)<=0?$.getFullYear()+1:$.getFullYear():$.getFullYear()-1}var W={"%a":m=>g[m.tm_wday].substring(0,3),"%A":m=>g[m.tm_wday],"%b":m=>T[m.tm_mon].substring(0,3),"%B":m=>T[m.tm_mon],"%C":m=>{var $=m.tm_year+1900;return P($/100|0,2)},"%d":m=>P(m.tm_mday,2),"%e":m=>S(m.tm_mday,2," "),"%g":m=>z(m).toString().substring(2),"%G":m=>z(m),"%H":m=>P(m.tm_hour,2),"%I":m=>{var $=m.tm_hour;return $==0?$=12:$>12&&($-=12),P($,2)},"%j":m=>P(m.tm_mday+Va(st(m.tm_year+1900)?ur:lr,m.tm_mon-1),3),"%m":m=>P(m.tm_mon+1,2),"%M":m=>P(m.tm_min,2),"%n":()=>`
`,"%p":m=>m.tm_hour>=0&&m.tm_hour<12?"AM":"PM","%S":m=>P(m.tm_sec,2),"%t":()=>"	","%u":m=>m.tm_wday||7,"%U":m=>{var $=m.tm_yday+7-m.tm_wday;return P(Math.floor($/7),2)},"%V":m=>{var $=Math.floor((m.tm_yday+7-(m.tm_wday+6)%7)/7);if((m.tm_wday+371-m.tm_yday-2)%7<=2&&$++,$){if($==53){var J=(m.tm_wday+371-m.tm_yday)%7;J!=4&&(J!=3||!st(m.tm_year))&&($=1)}}else{$=52;var Y=(m.tm_wday+7-m.tm_yday-1)%7;(Y==4||Y==5&&st(m.tm_year%400-1))&&$++}return P($,2)},"%w":m=>m.tm_wday,"%W":m=>{var $=m.tm_yday+7-(m.tm_wday+6)%7;return P(Math.floor($/7),2)},"%y":m=>(m.tm_year+1900).toString().substring(2),"%Y":m=>m.tm_year+1900,"%z":m=>{var $=m.tm_gmtoff,J=$>=0;return $=Math.abs($)/60,$=$/60*100+$%60,(J?"+":"-")+("0000"+$).slice(-4)},"%Z":m=>m.tm_zone,"%%":()=>"%"};d=d.replace(/%%/g,"\0\0");for(var v in W)d.includes(v)&&(d=d.replace(new RegExp(v,"g"),W[v](l)));d=d.replace(/\0\0/g,"%");var X=za(d);return X.length>r?0:(Ja(X,t),X.length-1)},Ya=(t,r,o,i,c)=>Ga(t,r,o,i);Vt=n.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}},Cn(),Ee=n.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},jn(),On(),Hn(),er=n.UnboundTypeError=qn(Error,"UnboundTypeError"),Qn(),Kn();var Qa={s:ln,u:dn,b:pn,g:hn,q:vn,J:yn,f:mn,V:gn,d:fn,da:wn,Q:bn,_:_n,ca:zn,ba:Gn,w:Yn,Y:Zn,x:ta,h:ra,L:aa,M:oa,t:sa,o:ca,K:da,C:ga,A:wa,ea:ba,$:Ca,R:Ta,ha:jt,fa:Sa,Z:xa,N:Ma,O:Aa,aa:ja,B:ka,X:Ra,W:Wa,T:Ha,U:La,E:po,D:to,F:fo,n:ho,a:Xa,e:no,m:eo,k:oo,H:uo,v:so,G:lo,z:yo,P:go,l:ao,j:ro,c:Za,p:Ka,I:co,r:vo,i:io,y:mo,ga:Ba,S:Ya},G=un(),pe=n._free=t=>(pe=n._free=G.ka)(t),Nt=n._malloc=t=>(Nt=n._malloc=G.la)(t),dr=t=>(dr=G.na)(t),U=(t,r)=>(U=G.oa)(t,r),He=t=>(He=G.pa)(t),V=()=>(V=G.qa)(),q=t=>(q=G.ra)(t),fr=t=>(fr=G.sa)(t),pr=t=>(pr=G.ta)(t),hr=(t,r,o)=>(hr=G.ua)(t,r,o),vr=t=>(vr=G.va)(t);n.dynCall_viijii=(t,r,o,i,c,l,d)=>(n.dynCall_viijii=G.wa)(t,r,o,i,c,l,d);var yr=n.dynCall_jiiii=(t,r,o,i,c)=>(yr=n.dynCall_jiiii=G.xa)(t,r,o,i,c);n.dynCall_iiiiij=(t,r,o,i,c,l,d)=>(n.dynCall_iiiiij=G.ya)(t,r,o,i,c,l,d),n.dynCall_iiiiijj=(t,r,o,i,c,l,d,f,v)=>(n.dynCall_iiiiijj=G.za)(t,r,o,i,c,l,d,f,v),n.dynCall_iiiiiijj=(t,r,o,i,c,l,d,f,v,g)=>(n.dynCall_iiiiiijj=G.Aa)(t,r,o,i,c,l,d,f,v,g);function Xa(t,r){var o=V();try{return B(t)(r)}catch(i){if(q(o),i!==i+0)throw i;U(1,0)}}function Ka(t,r,o,i){var c=V();try{B(t)(r,o,i)}catch(l){if(q(c),l!==l+0)throw l;U(1,0)}}function Za(t,r,o){var i=V();try{B(t)(r,o)}catch(c){if(q(i),c!==c+0)throw c;U(1,0)}}function eo(t,r,o,i){var c=V();try{return B(t)(r,o,i)}catch(l){if(q(c),l!==l+0)throw l;U(1,0)}}function to(t,r,o,i,c){var l=V();try{return B(t)(r,o,i,c)}catch(d){if(q(l),d!==d+0)throw d;U(1,0)}}function ro(t,r){var o=V();try{B(t)(r)}catch(i){if(q(o),i!==i+0)throw i;U(1,0)}}function no(t,r,o){var i=V();try{return B(t)(r,o)}catch(c){if(q(i),c!==c+0)throw c;U(1,0)}}function ao(t){var r=V();try{B(t)()}catch(o){if(q(r),o!==o+0)throw o;U(1,0)}}function oo(t,r,o,i,c){var l=V();try{return B(t)(r,o,i,c)}catch(d){if(q(l),d!==d+0)throw d;U(1,0)}}function io(t,r,o,i,c,l,d,f,v,g,T){var S=V();try{B(t)(r,o,i,c,l,d,f,v,g,T)}catch(P){if(q(S),P!==P+0)throw P;U(1,0)}}function so(t,r,o,i,c,l,d){var f=V();try{return B(t)(r,o,i,c,l,d)}catch(v){if(q(f),v!==v+0)throw v;U(1,0)}}function co(t,r,o,i,c){var l=V();try{B(t)(r,o,i,c)}catch(d){if(q(l),d!==d+0)throw d;U(1,0)}}function uo(t,r,o,i,c,l){var d=V();try{return B(t)(r,o,i,c,l)}catch(f){if(q(d),f!==f+0)throw f;U(1,0)}}function lo(t,r,o,i,c,l,d,f){var v=V();try{return B(t)(r,o,i,c,l,d,f)}catch(g){if(q(v),g!==g+0)throw g;U(1,0)}}function fo(t,r,o,i){var c=V();try{return B(t)(r,o,i)}catch(l){if(q(c),l!==l+0)throw l;U(1,0)}}function po(t,r,o,i){var c=V();try{return B(t)(r,o,i)}catch(l){if(q(c),l!==l+0)throw l;U(1,0)}}function ho(t){var r=V();try{return B(t)()}catch(o){if(q(r),o!==o+0)throw o;U(1,0)}}function vo(t,r,o,i,c,l,d,f){var v=V();try{B(t)(r,o,i,c,l,d,f)}catch(g){if(q(v),g!==g+0)throw g;U(1,0)}}function yo(t,r,o,i,c,l,d,f,v,g,T,S){var P=V();try{return B(t)(r,o,i,c,l,d,f,v,g,T,S)}catch(x){if(q(P),x!==x+0)throw x;U(1,0)}}function mo(t,r,o,i,c,l,d,f,v,g,T,S,P,x,H,z){var W=V();try{B(t)(r,o,i,c,l,d,f,v,g,T,S,P,x,H,z)}catch(X){if(q(W),X!==X+0)throw X;U(1,0)}}function go(t,r,o,i,c){var l=V();try{return yr(t,r,o,i,c)}catch(d){if(q(l),d!==d+0)throw d;U(1,0)}}var ct;Ce=function t(){ct||mr(),ct||(Ce=t)};function mr(){if(ie>0||(ze(),ie>0))return;function t(){ct||(ct=!0,n.calledRun=!0,!F&&(vt(),s(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),yt()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return mr(),a.ready}})();function ri(e){return Lt(Bt,e)}async function ni(e,a){return ei(Bt,e,a)}async function ai(e,a){return ti(Bt,e,a)}var Be;class Ut extends EventTarget{constructor(a={}){var n;super(),xo(this,Be,void 0);try{const s=(n=a==null?void 0:a.formats)==null?void 0:n.filter(u=>u!=="unknown");if((s==null?void 0:s.length)===0)throw new TypeError("Hint option provided, but is empty.");s==null||s.forEach(u=>{if(!ft.has(u))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${u}' is not a valid enum value of type BarcodeFormat.`)}),Mo(this,Be,s??[]),ri().then(u=>{this.dispatchEvent(new CustomEvent("load",{detail:u}))}).catch(u=>{this.dispatchEvent(new CustomEvent("error",{detail:u}))})}catch(s){throw _r(s,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return Ao.filter(a=>a!=="unknown")}async detect(a){try{const n=await No(a);if(n===null)return[];let s;try{Lr(n)?s=await ni(n,{tryHarder:!0,formats:Tr(this,Be).map(u=>ft.get(u))}):s=await ai(n,{tryHarder:!0,formats:Tr(this,Be).map(u=>ft.get(u))})}catch(u){throw console.error(u),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return s.map(u=>{const{topLeft:{x:h,y},topRight:{x:_,y:p},bottomLeft:{x:w,y:C},bottomRight:{x:b,y:A}}=u.position,j=Math.min(h,_,w,b),M=Math.min(y,p,C,A),F=Math.max(h,_,w,b),N=Math.max(y,p,C,A);return{boundingBox:new DOMRectReadOnly(j,M,F-j,N-M),rawValue:u.text,format:jo(u.format),cornerPoints:[{x:h,y},{x:_,y:p},{x:b,y:A},{x:w,y:C}]}})}catch(n){throw _r(n,"Failed to execute 'detect' on 'BarcodeDetector'")}}}Be=new WeakMap;const zr=(e,a,n="error")=>{let s,u;const h=new Promise((y,_)=>{s=y,u=_,e.addEventListener(a,s),e.addEventListener(n,u)});return h.finally(()=>{e.removeEventListener(a,s),e.removeEventListener(n,u)}),h},Er=e=>new Promise(a=>setTimeout(a,e));class Jr extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class oi extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}class ii extends Error{constructor(){super("Loading camera stream timed out after 6 seconds. If you are on iOS in PWA mode, this is a known issue (see https://github.com/gruhn/vue-qrcode-reader/issues/298)"),this.name="StreamLoadTimeoutError"}}let Gr;async function si(e){if(window.BarcodeDetector===void 0)return console.debug("[vue-qrcode-reader] Native BarcodeDetector not supported. Will use polyfill."),new Ut({formats:e});const a=await window.BarcodeDetector.getSupportedFormats(),n=e.filter(s=>!a.includes(s));return n.length>0?(console.debug(`[vue-qrcode-reader] Native BarcodeDetector does not support formats ${JSON.stringify(n)}. Will use polyfill.`),new Ut({formats:e})):(console.debug("[vue-qrcode-reader] Will use native BarcodeDetector."),new window.BarcodeDetector({formats:e}))}async function Yr(e){Gr=await si(e)}const ci=async(e,{detectHandler:a,locateHandler:n,minDelay:s,formats:u})=>{console.debug("[vue-qrcode-reader] start scanning"),await Yr(u);const h=y=>async _=>{if(e.readyState===0)console.debug("[vue-qrcode-reader] stop scanning: video element readyState is 0");else{const{lastScanned:p,contentBefore:w,lastScanHadContent:C}=y;if(_-p<s)window.requestAnimationFrame(h(y));else{const b=await Gr.detect(e),A=b.some(F=>!w.includes(F.rawValue));A&&a(b);const j=b.length>0;j&&n(b),!j&&C&&n(b);const M={lastScanned:_,lastScanHadContent:j,contentBefore:A?b.map(F=>F.rawValue):w};window.requestAnimationFrame(h(M))}}};h({lastScanned:performance.now(),contentBefore:[],lastScanHadContent:!1})(performance.now())},ui=async(e,a=["qr_code"])=>await new Ut({formats:a}).detect(e);var Qr={},K={};Object.defineProperty(K,"__esModule",{value:!0});K.compactObject=Zr;K.deprecated=gi;var li=K.detectBrowser=wi;K.disableLog=vi;K.disableWarnings=yi;K.extractVersion=pt;K.filterStats=bi;K.log=mi;K.walkStats=ht;K.wrapPeerConnectionEvent=hi;function di(e,a,n){return a=fi(a),a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function fi(e){var a=pi(e,"string");return we(a)==="symbol"?a:String(a)}function pi(e,a){if(we(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,a||"default");if(we(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function we(e){"@babel/helpers - typeof";return we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},we(e)}var Xr=!0,Kr=!0;function pt(e,a,n){var s=e.match(a);return s&&s.length>=n&&parseInt(s[n],10)}function hi(e,a,n){if(e.RTCPeerConnection){var s=e.RTCPeerConnection.prototype,u=s.addEventListener;s.addEventListener=function(y,_){if(y!==a)return u.apply(this,arguments);var p=function(w){var C=n(w);C&&(_.handleEvent?_.handleEvent(C):_(C))};return this._eventMap=this._eventMap||{},this._eventMap[a]||(this._eventMap[a]=new Map),this._eventMap[a].set(_,p),u.apply(this,[y,p])};var h=s.removeEventListener;s.removeEventListener=function(y,_){if(y!==a||!this._eventMap||!this._eventMap[a])return h.apply(this,arguments);if(!this._eventMap[a].has(_))return h.apply(this,arguments);var p=this._eventMap[a].get(_);return this._eventMap[a].delete(_),this._eventMap[a].size===0&&delete this._eventMap[a],Object.keys(this._eventMap).length===0&&delete this._eventMap,h.apply(this,[y,p])},Object.defineProperty(s,"on"+a,{get:function(){return this["_on"+a]},set:function(y){this["_on"+a]&&(this.removeEventListener(a,this["_on"+a]),delete this["_on"+a]),y&&this.addEventListener(a,this["_on"+a]=y)},enumerable:!0,configurable:!0})}}function vi(e){return typeof e!="boolean"?new Error("Argument type: "+we(e)+". Please use a boolean."):(Xr=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function yi(e){return typeof e!="boolean"?new Error("Argument type: "+we(e)+". Please use a boolean."):(Kr=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function mi(){if((typeof window>"u"?"undefined":we(window))==="object"){if(Xr)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function gi(e,a){Kr&&console.warn(e+" is deprecated, please use "+a+" instead.")}function wi(e){var a={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return a.browser="Not a browser.",a;var n=e.navigator;if(n.mozGetUserMedia)a.browser="firefox",a.version=pt(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)a.browser="chrome",a.version=pt(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))a.browser="safari",a.version=pt(n.userAgent,/AppleWebKit\/(\d+)\./,1),a.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return a.browser="Not a supported browser.",a;return a}function Dr(e){return Object.prototype.toString.call(e)==="[object Object]"}function Zr(e){return Dr(e)?Object.keys(e).reduce(function(a,n){var s=Dr(e[n]),u=s?Zr(e[n]):e[n],h=s&&!Object.keys(u).length;return u===void 0||h?a:Object.assign(a,di({},n,u))},{}):e}function ht(e,a,n){!a||n.has(a.id)||(n.set(a.id,a),Object.keys(a).forEach(function(s){s.endsWith("Id")?ht(e,e.get(a[s]),n):s.endsWith("Ids")&&a[s].forEach(function(u){ht(e,e.get(u),n)})}))}function bi(e,a,n){var s=n?"outbound-rtp":"inbound-rtp",u=new Map;if(a===null)return u;var h=[];return e.forEach(function(y){y.type==="track"&&y.trackIdentifier===a.id&&h.push(y)}),h.forEach(function(y){e.forEach(function(_){_.type===s&&_.trackId===y.id&&ht(e,_,u)})}),u}Object.defineProperty(Qr,"__esModule",{value:!0});var Ci=Qr.shimGetUserMedia=$i,Ti=_i(K);function en(e){if(typeof WeakMap!="function")return null;var a=new WeakMap,n=new WeakMap;return(en=function(s){return s?n:a})(e)}function _i(e,a){if(e.__esModule)return e;if(e===null||ge(e)!=="object"&&typeof e!="function")return{default:e};var n=en(a);if(n&&n.has(e))return n.get(e);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in e)if(h!=="default"&&Object.prototype.hasOwnProperty.call(e,h)){var y=u?Object.getOwnPropertyDescriptor(e,h):null;y&&(y.get||y.set)?Object.defineProperty(s,h,y):s[h]=e[h]}return s.default=e,n&&n.set(e,s),s}function ge(e){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ge(e)}var Or=Ti.log;function $i(e,a){var n=e&&e.navigator;if(n.mediaDevices){var s=function(p){if(ge(p)!=="object"||p.mandatory||p.optional)return p;var w={};return Object.keys(p).forEach(function(C){if(!(C==="require"||C==="advanced"||C==="mediaSource")){var b=ge(p[C])==="object"?p[C]:{ideal:p[C]};b.exact!==void 0&&typeof b.exact=="number"&&(b.min=b.max=b.exact);var A=function(M,F){return M?M+F.charAt(0).toUpperCase()+F.slice(1):F==="deviceId"?"sourceId":F};if(b.ideal!==void 0){w.optional=w.optional||[];var j={};typeof b.ideal=="number"?(j[A("min",C)]=b.ideal,w.optional.push(j),j={},j[A("max",C)]=b.ideal,w.optional.push(j)):(j[A("",C)]=b.ideal,w.optional.push(j))}b.exact!==void 0&&typeof b.exact!="number"?(w.mandatory=w.mandatory||{},w.mandatory[A("",C)]=b.exact):["min","max"].forEach(function(M){b[M]!==void 0&&(w.mandatory=w.mandatory||{},w.mandatory[A(M,C)]=b[M])})}}),p.advanced&&(w.optional=(w.optional||[]).concat(p.advanced)),w},u=function(p,w){if(a.version>=61)return w(p);if(p=JSON.parse(JSON.stringify(p)),p&&ge(p.audio)==="object"){var C=function(M,F,N){F in M&&!(N in M)&&(M[N]=M[F],delete M[F])};p=JSON.parse(JSON.stringify(p)),C(p.audio,"autoGainControl","googAutoGainControl"),C(p.audio,"noiseSuppression","googNoiseSuppression"),p.audio=s(p.audio)}if(p&&ge(p.video)==="object"){var b=p.video.facingMode;b=b&&(ge(b)==="object"?b:{ideal:b});var A=a.version<66;if(b&&(b.exact==="user"||b.exact==="environment"||b.ideal==="user"||b.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!A)){delete p.video.facingMode;var j;if(b.exact==="environment"||b.ideal==="environment"?j=["back","rear"]:(b.exact==="user"||b.ideal==="user")&&(j=["front"]),j)return n.mediaDevices.enumerateDevices().then(function(M){M=M.filter(function(N){return N.kind==="videoinput"});var F=M.find(function(N){return j.some(function(E){return N.label.toLowerCase().includes(E)})});return!F&&M.length&&j.includes("back")&&(F=M[M.length-1]),F&&(p.video.deviceId=b.exact?{exact:F.deviceId}:{ideal:F.deviceId}),p.video=s(p.video),Or("chrome: "+JSON.stringify(p)),w(p)})}p.video=s(p.video)}return Or("chrome: "+JSON.stringify(p)),w(p)},h=function(p){return a.version>=64?p:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[p.name]||p.name,message:p.message,constraint:p.constraint||p.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},y=function(p,w,C){u(p,function(b){n.webkitGetUserMedia(b,w,function(A){C&&C(h(A))})})};if(n.getUserMedia=y.bind(n),n.mediaDevices.getUserMedia){var _=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(p){return u(p,function(w){return _(w).then(function(C){if(w.audio&&!C.getAudioTracks().length||w.video&&!C.getVideoTracks().length)throw C.getTracks().forEach(function(b){b.stop()}),new DOMException("","NotFoundError");return C},function(C){return Promise.reject(h(C))})})}}}}var tn={};Object.defineProperty(tn,"__esModule",{value:!0});var Si=tn.shimGetUserMedia=Di,Pi=Ei(K);function rn(e){if(typeof WeakMap!="function")return null;var a=new WeakMap,n=new WeakMap;return(rn=function(s){return s?n:a})(e)}function Ei(e,a){if(e.__esModule)return e;if(e===null||Oe(e)!=="object"&&typeof e!="function")return{default:e};var n=rn(a);if(n&&n.has(e))return n.get(e);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in e)if(h!=="default"&&Object.prototype.hasOwnProperty.call(e,h)){var y=u?Object.getOwnPropertyDescriptor(e,h):null;y&&(y.get||y.set)?Object.defineProperty(s,h,y):s[h]=e[h]}return s.default=e,n&&n.set(e,s),s}function Oe(e){"@babel/helpers - typeof";return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Oe(e)}function Di(e,a){var n=e&&e.navigator,s=e&&e.MediaStreamTrack;if(n.getUserMedia=function(p,w,C){Pi.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(p).then(w,C)},!(a.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var u=function(p,w,C){w in p&&!(C in p)&&(p[C]=p[w],delete p[w])},h=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(p){return Oe(p)==="object"&&Oe(p.audio)==="object"&&(p=JSON.parse(JSON.stringify(p)),u(p.audio,"autoGainControl","mozAutoGainControl"),u(p.audio,"noiseSuppression","mozNoiseSuppression")),h(p)},s&&s.prototype.getSettings){var y=s.prototype.getSettings;s.prototype.getSettings=function(){var p=y.apply(this,arguments);return u(p,"mozAutoGainControl","autoGainControl"),u(p,"mozNoiseSuppression","noiseSuppression"),p}}if(s&&s.prototype.applyConstraints){var _=s.prototype.applyConstraints;s.prototype.applyConstraints=function(p){return this.kind==="audio"&&Oe(p)==="object"&&(p=JSON.parse(JSON.stringify(p)),u(p,"autoGainControl","mozAutoGainControl"),u(p,"noiseSuppression","mozNoiseSuppression")),_.apply(this,[p])}}}}var le={};Object.defineProperty(le,"__esModule",{value:!0});le.shimAudioContext=Wi;le.shimCallbacksAPI=ji;le.shimConstraints=on;le.shimCreateOfferLegacy=Fi;var Oi=le.shimGetUserMedia=ki;le.shimLocalStreamsAPI=Mi;le.shimRTCIceServerUrls=Ri;le.shimRemoteStreamsAPI=Ai;le.shimTrackEventTransceiver=Ii;var nn=xi(K);function an(e){if(typeof WeakMap!="function")return null;var a=new WeakMap,n=new WeakMap;return(an=function(s){return s?n:a})(e)}function xi(e,a){if(e.__esModule)return e;if(e===null||be(e)!=="object"&&typeof e!="function")return{default:e};var n=an(a);if(n&&n.has(e))return n.get(e);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in e)if(h!=="default"&&Object.prototype.hasOwnProperty.call(e,h)){var y=u?Object.getOwnPropertyDescriptor(e,h):null;y&&(y.get||y.set)?Object.defineProperty(s,h,y):s[h]=e[h]}return s.default=e,n&&n.set(e,s),s}function be(e){"@babel/helpers - typeof";return be=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},be(e)}function Mi(e){if(!(be(e)!=="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var a=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(n){var s=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(function(u){return a.call(s,u,n)}),n.getVideoTracks().forEach(function(u){return a.call(s,u,n)})},e.RTCPeerConnection.prototype.addTrack=function(n){for(var s=this,u=arguments.length,h=new Array(u>1?u-1:0),y=1;y<u;y++)h[y-1]=arguments[y];return h&&h.forEach(function(_){s._localStreams?s._localStreams.includes(_)||s._localStreams.push(_):s._localStreams=[_]}),a.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){var s=this;this._localStreams||(this._localStreams=[]);var u=this._localStreams.indexOf(n);if(u!==-1){this._localStreams.splice(u,1);var h=n.getTracks();this.getSenders().forEach(function(y){h.includes(y.track)&&s.removeTrack(y)})}})}}function Ai(e){if(!(be(e)!=="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(n){var s=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=function(u){u.streams.forEach(function(h){if(s._remoteStreams||(s._remoteStreams=[]),!s._remoteStreams.includes(h)){s._remoteStreams.push(h);var y=new Event("addstream");y.stream=h,s.dispatchEvent(y)}})})}});var a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(function(u){if(n._remoteStreams||(n._remoteStreams=[]),!(n._remoteStreams.indexOf(u)>=0)){n._remoteStreams.push(u);var h=new Event("addstream");h.stream=u,n.dispatchEvent(h)}})}),a.apply(n,arguments)}}}function ji(e){if(!(be(e)!=="object"||!e.RTCPeerConnection)){var a=e.RTCPeerConnection.prototype,n=a.createOffer,s=a.createAnswer,u=a.setLocalDescription,h=a.setRemoteDescription,y=a.addIceCandidate;a.createOffer=function(p,w){var C=arguments.length>=2?arguments[2]:arguments[0],b=n.apply(this,[C]);return w?(b.then(p,w),Promise.resolve()):b},a.createAnswer=function(p,w){var C=arguments.length>=2?arguments[2]:arguments[0],b=s.apply(this,[C]);return w?(b.then(p,w),Promise.resolve()):b};var _=function(p,w,C){var b=u.apply(this,[p]);return C?(b.then(w,C),Promise.resolve()):b};a.setLocalDescription=_,_=function(p,w,C){var b=h.apply(this,[p]);return C?(b.then(w,C),Promise.resolve()):b},a.setRemoteDescription=_,_=function(p,w,C){var b=y.apply(this,[p]);return C?(b.then(w,C),Promise.resolve()):b},a.addIceCandidate=_}}function ki(e){var a=e&&e.navigator;if(a.mediaDevices&&a.mediaDevices.getUserMedia){var n=a.mediaDevices,s=n.getUserMedia.bind(n);a.mediaDevices.getUserMedia=function(u){return s(on(u))}}!a.getUserMedia&&a.mediaDevices&&a.mediaDevices.getUserMedia&&(a.getUserMedia=(function(u,h,y){a.mediaDevices.getUserMedia(u).then(h,y)}).bind(a))}function on(e){return e&&e.video!==void 0?Object.assign({},e,{video:nn.compactObject(e.video)}):e}function Ri(e){if(e.RTCPeerConnection){var a=e.RTCPeerConnection;e.RTCPeerConnection=function(n,s){if(n&&n.iceServers){for(var u=[],h=0;h<n.iceServers.length;h++){var y=n.iceServers[h];y.urls===void 0&&y.url?(nn.deprecated("RTCIceServer.url","RTCIceServer.urls"),y=JSON.parse(JSON.stringify(y)),y.urls=y.url,delete y.url,u.push(y)):u.push(n.iceServers[h])}n.iceServers=u}return new a(n,s)},e.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in a&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})}}function Ii(e){be(e)==="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Fi(e){var a=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);var s=this.getTransceivers().find(function(h){return h.receiver.track.kind==="audio"});n.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):n.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);var u=this.getTransceivers().find(function(h){return h.receiver.track.kind==="video"});n.offerToReceiveVideo===!1&&u?u.direction==="sendrecv"?u.setDirection?u.setDirection("sendonly"):u.direction="sendonly":u.direction==="recvonly"&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive"):n.offerToReceiveVideo===!0&&!u&&this.addTransceiver("video",{direction:"recvonly"})}return a.apply(this,arguments)}}function Wi(e){be(e)!=="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const Ni=e=>{let a=!1,n;return(...s)=>(a||(n=e(s),a=!0),n)};function ue(e,a){if(e===!1)throw new Error(a??"assertion failure")}function xr(e){throw new Error("this code should be unreachable")}const Ui=Ni(()=>{const e=li(window);switch(e.browser){case"chrome":Ci(window,e);break;case"firefox":Si(window,e);break;case"safari":Oi(window,e);break;default:throw new Jr}});let xe=Promise.resolve({type:"stop",data:{}});async function Mr(e,a,n){var s,u,h;if(console.debug("[vue-qrcode-reader] starting camera with constraints: ",JSON.stringify(a)),window.isSecureContext!==!0)throw new oi;if(((s=navigator==null?void 0:navigator.mediaDevices)==null?void 0:s.getUserMedia)===void 0)throw new Jr;Ui(),console.debug("[vue-qrcode-reader] calling getUserMedia");const y=await navigator.mediaDevices.getUserMedia({audio:!1,video:a});e.srcObject!==void 0?e.srcObject=y:e.mozSrcObject!==void 0?e.mozSrcObject=y:window.URL.createObjectURL?e.src=window.URL.createObjectURL(y):window.webkitURL?e.src=window.webkitURL.createObjectURL(y):e.src=y.id,e.play(),console.debug("[vue-qrcode-reader] waiting for video element to load"),await Promise.race([zr(e,"loadeddata"),Er(6e3).then(()=>{throw new ii})]),console.debug("[vue-qrcode-reader] video element loaded"),await Er(500);const[_]=y.getVideoTracks(),p=(h=(u=_==null?void 0:_.getCapabilities)==null?void 0:u.call(_))!=null?h:{};let w=!1;return n&&p.torch&&(await _.applyConstraints({advanced:[{torch:!0}]}),w=!0),console.debug("[vue-qrcode-reader] camera ready"),{type:"start",data:{videoEl:e,stream:y,capabilities:p,constraints:a,isTorchOn:w}}}async function Hi(e,{constraints:a,torch:n,restart:s=!1}){xe=xe.then(h=>{if(h.type==="start"){const{data:{videoEl:y,stream:_,constraints:p,isTorchOn:w}}=h;return!s&&e===y&&a===p&&n===w?h:sn(y,_,w).then(()=>Mr(e,a,n))}else if(h.type==="stop"||h.type==="failed")return Mr(e,a,n);xr()}).catch(h=>(console.debug(`[vue-qrcode-reader] starting camera failed with "${h}"`),{type:"failed",error:h}));const u=await xe;if(u.type==="stop")throw new Error("Something went wrong with the camera task queue (start task).");if(u.type==="failed")throw u.error;if(u.type==="start")return u.data.capabilities;xr()}async function sn(e,a,n){console.debug("[vue-qrcode-reader] stopping camera"),e.src="",e.srcObject=null,e.load(),await zr(e,"error");for(const s of a.getTracks())n!=null||await s.applyConstraints({advanced:[{torch:!1}]}),a.removeTrack(s),s.stop();return{type:"stop",data:{}}}async function lt(){if(xe=xe.then(e=>{if(e.type==="stop"||e.type==="failed")return e;const{data:{videoEl:a,stream:n,isTorchOn:s}}=e;return sn(a,n,s)}),(await xe).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")}const Li=Ht({__name:"QrcodeStream",props:{constraints:{default:()=>({facingMode:"environment"})},formats:{default:()=>["qr_code"]},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function,default:void 0}},emits:["detect","camera-on","camera-off","error"],setup(e,{emit:a}){const n=e,s=a,u=te(n.constraints),h=te(n.formats);Le(()=>n.constraints,(I,D)=>{JSON.stringify(I)!==JSON.stringify(D)&&(u.value=I)},{deep:!0}),Le(()=>n.formats,(I,D)=>{JSON.stringify(I)!==JSON.stringify(D)&&(h.value=I)},{deep:!0});const y=te(),_=te(),p=te(),w=te(!1),C=te(!1);Ar(()=>{C.value=!0}),bo(()=>{lt()});const b=dt(()=>({torch:n.torch,constraints:u.value,shouldStream:C.value&&!n.paused}));Le(b,async I=>{const D=p.value;ue(D!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus video element should always be defined.");const O=y.value;ue(O!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus canvas should always be defined.");const oe=O.getContext("2d");if(ue(oe!==null,"if cavnas is defined, canvas 2d context should also be non-null"),I.shouldStream){lt(),w.value=!1;try{const re=await Hi(D,I);C.value?(w.value=!0,s("camera-on",re)):await lt()}catch(re){s("error",re)}}else O.width=D.videoWidth,O.height=D.videoHeight,oe.drawImage(D,0,0,D.videoWidth,D.videoHeight),lt(),w.value=!1,s("camera-off")},{deep:!0}),Le(h,async I=>{C.value&&await Yr(I)});const A=dt(()=>b.value.shouldStream&&w.value);Le(A,I=>{if(I){ue(y.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus pause frame canvas is defined"),j(y.value),ue(_.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus tracking canvas is defined"),j(_.value);const D=()=>n.track===void 0?500:40;ue(p.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus video element is defined"),ci(p.value,{detectHandler:O=>s("detect",O),formats:h.value,locateHandler:M,minDelay:D()})}});const j=I=>{const D=I.getContext("2d");ue(D!==null,"canvas 2d context should always be non-null"),D.clearRect(0,0,I.width,I.height)},M=I=>{const D=_.value;ue(D!==void 0,"onLocate handler should only be called when component is mounted. Thus tracking canvas is always defined.");const O=p.value;if(ue(O!==void 0,"onLocate handler should only be called when component is mounted. Thus video element is always defined."),I.length===0||n.track===void 0)j(D);else{const oe=O.offsetWidth,re=O.offsetHeight,$e=O.videoWidth,Se=O.videoHeight,Ae=Math.max(oe/$e,re/Se),je=$e*Ae,ze=Se*Ae,vt=je/$e,yt=ze/Se,mt=(oe-je)/2,gt=(re-ze)/2,ke=({x:he,y:Z})=>({x:Math.floor(he*vt),y:Math.floor(Z*yt)}),ie=({x:he,y:Z})=>({x:Math.floor(he+mt),y:Math.floor(Z+gt)}),Ce=I.map(he=>{const{boundingBox:Z,cornerPoints:wt}=he,{x:Ge,y:ve}=ie(ke({x:Z.x,y:Z.y})),{x:Ye,y:bt}=ke({x:Z.width,y:Z.height});return{...he,cornerPoints:wt.map(Qe=>ie(ke(Qe))),boundingBox:DOMRectReadOnly.fromRect({x:Ge,y:ve,width:Ye,height:bt})}});D.width=O.offsetWidth,D.height=O.offsetHeight;const Je=D.getContext("2d");ue(Je!==null,"canvas 2d context should always be non-null"),n.track(Ce,Je)}},F={width:"100%",height:"100%",position:"relative","z-index":"0"},N={width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},E={width:"100%",height:"100%","object-fit":"cover"},k=dt(()=>A.value?E:{...E,visibility:"hidden",position:"absolute"});return(I,D)=>(Ve(),qe("div",{style:F},[L("video",{ref_key:"videoRef",ref:p,style:Co(k.value),autoplay:"",muted:"",playsinline:""},null,4),To(L("canvas",{id:"qrcode-stream-pause-frame",ref_key:"pauseFrameRef",ref:y,style:E},null,512),[[_o,!A.value]]),L("canvas",{id:"qrcode-stream-tracking-layer",ref_key:"trackingLayerRef",ref:_,style:N},null,512),L("div",{style:N},[$o(I.$slots,"default")])]))}}),Bi=Ht({__name:"QrcodeCapture",props:{formats:{default:()=>["qr_code"]}},emits:["detect"],setup(e,{emit:a}){const n=e,s=a,u=h=>{if(!(!(h.target instanceof HTMLInputElement)||!h.target.files))for(const y of Array.from(h.target.files))ui(y,n.formats).then(_=>{s("detect",_)})};return(h,y)=>(Ve(),qe("input",{onChange:u,type:"file",name:"image",accept:"image/*",capture:"environment",multiple:""},null,32))}}),Vi={class:"absolute top-full w-full text-center mt-16"},qi=L("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",viewBox:"0 0 48 48"},[L("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4"},[L("path",{d:"M12 11h5l2-4h10l2 4h5v16H12z"}),L("circle",{cx:"24",cy:"18",r:"4"}),L("path",{d:"M24 38C12.954 38 4 33.523 4 28c0-1.422.594-2.775 1.664-4M24 38l-4-4m4 4l-4 4m12-4.832C39.064 35.625 44 32.1 44 28c0-1.422-.594-2.775-1.664-4"})])],-1),zi=[qi],Ji=L("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",viewBox:"0 0 48 48"},[L("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4"},[L("path",{d:"M39 6H9a3 3 0 0 0-3 3v30a3 3 0 0 0 3 3h30a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3"}),L("path",{d:"M18 23a5 5 0 1 0 0-10a5 5 0 0 0 0 10m24 13L31 26l-10 9l-7-6l-8 6"})])],-1),Gi=[Ji],Yi=L("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-width":"4"},[L("path",{"stroke-linejoin":"round",d:"M31 4H16l-6 23h8l-4 17l26-28H28z"}),L("path",{d:"m21 11l-2 8"})],-1),Qi=[Yi],Xi={class:"footer pt-2 fixed right-0 left-0 bottom-0"},Ki={class:"flex justify-center"},Zi={class:"mr-2"},rs=Ht({__name:"vueQrcodeReader",props:{width:{default:100},height:{default:100},lblCancel:{default:"Cancel"}},emits:["onCancel","onDetect","onError"],setup(e,{emit:a}){const n=a,s=te({facingMode:"environment",code:"",noRearCamera:!1,noFrontCamera:!1,paused:!1,torchActive:!1,torchNotSupported:!1,showScanConfirmation:!1}),u=te({aztec:!0,code_128:!0,code_39:!0,code_93:!0,codabar:!0,databar:!0,databar_expanded:!0,data_matrix:!0,dx_film_edge:!0,ean_13:!0,ean_8:!0,itf:!0,maxi_code:!0,micro_qr_code:!0,pdf417:!0,qr_code:!0,rm_qr_code:!0,upc_a:!0,upc_e:!0,linear_codes:!0,matrix_codes:!0}),h=dt(()=>Object.keys(u.value).filter(E=>u.value[E])),y=te(null),_=te(null),p=te([]);Ar(async()=>{p.value=(await navigator.mediaDevices.enumerateDevices()).filter(({kind:E})=>E==="videoinput"),p.value.length>0&&(_.value=p.value[0]),y.value&&y.value.$el.removeAttribute("capture")});const w=E=>new Promise(k=>{window.setTimeout(k,E)}),C=(E,k)=>{for(const I of E){const{boundingBox:{x:D,y:O,width:oe,height:re}}=I;k.lineWidth=2,k.strokeStyle="#007bff",k.strokeRect(D,O,oe,re)}},b=async E=>{s.value.code=JSON.stringify(E.map(k=>k.rawValue)),s.value.paused=!0,await w(500),s.value.paused=!1,n("onDetect",s.value)},A=()=>{switch(s.value.facingMode){case"environment":s.value.facingMode="user";break;case"user":s.value.facingMode="environment";break}},j=E=>{s.value.showScanConfirmation=!1,s.value.torchNotSupported=!E.torch},M=()=>{s.value.showScanConfirmation=!0},F=E=>{const k={name:"",value:""};k.name=E.name,E.name==="NotAllowedError"?k.value="you need to grant camera access permission":E.name==="NotFoundError"?k.value="no camera on this device":E.name==="NotSupportedError"?k.value="secure context required (HTTPS, localhost)":E.name==="NotReadableError"?k.value="is the camera already in use?":E.name==="OverconstrainedError"?k.value="installed cameras are not suitable":E.name==="StreamApiNotSupportedError"?k.value="Stream API is not supported in this browser":E.name==="InsecureContextError"?k.value="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":k.value+=E.message,n("onError",k)},N=()=>{s.value.paused=!0,n("onCancel",!0)};return(E,k)=>(Ve(),qe(Oo,null,[br(ae(Li),{class:"mt-3",constraints:ae(s),paused:ae(s).paused,torch:ae(s).torchActive,track:C,formats:ae(h),onDetect:b,onCameraOn:j,onCameraOff:M,onError:F},{default:So(()=>[L("div",Vi,[L("button",{onClick:A},zi),L("button",{onClick:k[0]||(k[0]=I=>ae(y).$el.click()),class:"ml-10"},Gi),ae(s).torchNotSupported?Eo("",!0):(Ve(),qe("button",{key:0,class:"ml-10",onClick:k[1]||(k[1]=I=>ae(s).torchActive=!ae(s).torchActive)},[(Ve(),qe("svg",{class:Po([ae(s).torchActive?"text-sky-600":""]),xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",viewBox:"0 0 48 48"},Qi,2))])),br(ae(Bi),{ref_key:"qrcodeCaptureRef",ref:y,class:"hidden",onDetect:b},null,512)])]),_:1},8,["constraints","paused","torch","formats"]),L("div",Xi,[L("div",Ki,[L("button",{onClick:N,class:"w-full items-center text-center content-center px-3 py-3 text-xs font-medium text-white bg-sky-500 dark:bg-sky-600"},[L("span",Zi,Do(E.lblCancel),1)])])])],64))}});export{rs as _,ts as u};
